# PySpark Tutorial

The purpose of this notebook was to learn PySpark beyond the 'vanilla' guides online (ex on Datacamp) and to become accustmomed to using PySpark.<br><br>This Notebook is split into 3 parts<br>
<b>First Part</b><br>
First part is very basic, the point was to simply load a csv file into pyspark, look at it, execute some queries on it to transform it a little and load the transforms dataframe.<br><br>
<b>Second Part</b><br>
The second part was the whole reason for me to create this notebook in the first place. Loading a csv file (or other types of files) is pretty simple, and somewhat unrealistic when considering how you would use pyspark for a real project (ex: on the job or for a research project). That is, I wanted to try to access a SQL database from pyspark. If we think about how a large scale product is set up, the data engineers will gather data from various sources and most likely store it in a database (either SQL or NoSQL). So part 2 is an exercise to connect PySpark to MySQL (MySQL because I have it installed locally).<br><br>
<b>Part Three</b><br>
The point of part 3 was to take things a little further and dive deeper into PySpark. In Part 2 we used the 'famous" wine quality data set (link in the notebook), which is very often used in machine learning tutorials. So might as well fight some models to the data using the MLlib library from PySpark. Here we fit 2 models. <br><br>First a Logistic Regression model to predict if a given wine is red or white. This model was fairly accurate at 99.80% correct predictions. <br><br>
Second, we fit a Random Forest Classifier to classify the wine. The purpose of this was to find the most important features in determining the quality of a given wine. Originally the model didnt't do so hot, being only 53% accuracy. Then we fined tuned the model using a parameter grid search and got the model accuracy up to 84% which is not to bad for the purpose of this exercise. The immediate factor causing a loss of accuracy of the model that comes to mind is that wine data set consists of red and white wine. It is entirely possible that features that determine the quality of red wine are very different than those for white wine. Nonetheless 84% accuracy is good and turns out that the most important features overall are alcohol content, volotile acidity, and sulphate content. <br><br><br>
<b><u>Disclaimer!!!</u></b><br><br>
The purpose of this notebook was for me to learn and better acquainted with PySPark; the purpose of this notebook is 100% for my education. That being said, I did follow some articles to learn. For the first part I followed <a href='https://towardsdatascience.com/create-your-first-etl-pipeline-in-apache-spark-and-python-ec3d12e2c169' target=_blank> this article</a> written by Adnan Siddiqi on Towards Data Science. For the second part and third part I followed <a href='https://towardsdatascience.com/pyspark-mysql-tutorial-fa3f7c26dc7' target=_blank>this article</a> written by Gregory Janesch on Towards Data Science. If there are any issues please let me know I can address them (even take down my notebook if need be). 
